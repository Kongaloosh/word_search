import pickle
import whois
__author__ = 'kongaloosh'

f = open('domains')
open_domains = """
AC
ACO
ACTIVE
ACTOR
AD
ADS
AE
AERO
AF
AFL
AG
AI
AIG
AL
AM
AMICA
AO
APP
AQ
AR
ARCHI
AS
ASIA
AT
AU
AW
AX
AXA
AZ
BA
BAND
BANK
BAR
BAUHAUS
BB
BBC
BBVA
BCN
BD
BE
BEER
BERLIN
BEST
BET
BF
BG
BH
BI
BIBLE
BID
BIO
BIZ
BJ
BLACK
BLUE
BM
BN
BNL
BNPPARIBAS
BO
BOATS
BOND
BOO
BOOTS
BOUTIQUE
BR
BRADESCO
BROKER
BROTHER
BRUSSELS
BS
BT
BUILD
BUZZ
BV
BW
BY
BZ
BZH
CA
CAB
CAFE
CAL
CAMERA
CAMP
CANON
CAPITAL
CARAVAN
CARDS
CARE
CAREER
CAREERS
CARS
CARTIER
CASA
CASH
CASINO
CAT
CATERING
CBA
CBN
CC
CD
CEB
CENTER
CEO
CERN
CF
CFA
CFD
CG
CH
CHANEL
CHANNEL
CHAT
CHEAP
CHLOE
CHRISTMAS
CHROME
CHURCH
CI
CISCO
CITIC
CITY
CK
CL
CLAIMS
CLEANING
CLICK
CLINIC
CLOTHING
CLOUD
CLUB
CM
CN
CO
COACH
CODES
COFFEE
COLLEGE
COLOGNE
COM
COMMBANK
COMMUNITY
COMPANY
COMPUTER
CONDOS
CONSTRUCTION
CONSULTING
CONTRACTORS
COOKING
COOL
COOP
CORSICA
COUNTRY
COUPONS
COURSES
CR
CREDIT
CREDITCARD
CRICKET
CROWN
CRS
CRUISES
CSC
CU
CUISINELLA
CV
CW
CX
CY
CYMRU
CYOU
CZ
DABUR
DAD
DANCE
DATE
DATING
DATSUN
DAY
DCLK
DE
DEALS
DEGREE
DELIVERY
DELTA
DEMOCRAT
DENTAL
DENTIST
DESI
DESIGN
DEV
DIAMONDS
DIET
DIGITAL
DIRECT
DIRECTORY
DISCOUNT
DJ
DK
DM
DNP
DO
DOCS
DOG
DOHA
DOMAINS
DOOSAN
DOWNLOAD
DRIVE
DURBAN
DVAG
DZ
EARTH
EAT
EC
EDU
EDUCATION
EE
EG
EMAIL
EMERCK
ENERGY
ENGINEER
ENGINEERING
ENTERPRISES
EPSON
EQUIPMENT
ER
ERNI
ES
ESQ
ESTATE
ET
EU
EUROVISION
EUS
EVENTS
EVERBANK
EXCHANGE
EXPERT
EXPOSED
EXPRESS
FAGE
FAIL
FAITH
FAMILY
FAN
FANS
FARM
FASHION
FEEDBACK
FI
FILM
FINANCE
FINANCIAL
FIRMDALE
FISH
FISHING
FIT
FITNESS
FJ
FK
FLIGHTS
FLORIST
FLOWERS
FLSMIDTH
FLY
FM
FO
FOO
FOOTBALL
FOREX
FORSALE
FORUM
FOUNDATION
FR
FRL
FROGANS
FUND
FURNITURE
FUTBOL
FYI
GA
GAL
GALLERY
GAME
GARDEN
GB
GBIZ
GD
GDN
GE
GEA
GENT
GENTING
GF
GG
GGEE
GH
GI
GIFT
GIFTS
GIVES
GIVING
GL
GLASS
GLE
GLOBAL
GLOBO
GM
GMAIL
GMO
GMX
GN
GOLD
GOLDPOINT
GOLF
GOO
GOOG
GOOGLE
GOP
GOV
GP
GQ
GR
GRAPHICS
GRATIS
GREEN
GRIPE
GROUP
GS
GT
GU
GUGE
GUIDE
GUITARS
GURU
GW
GY
HAMBURG
HANGOUT
HAUS
HEALTHCARE
HELP
HERE
HERMES
HIPHOP
HITACHI
HIV
HK
HM
HN
HOCKEY
HOLDINGS
HOLIDAY
HOMEDEPOT
HOMES
HONDA
HORSE
HOST
HOSTING
HOTELES
HOTMAIL
HOUSE
HOW
HR
HSBC
HT
HU
IBM
ICBC
ICE
ICU
ID
IE
IFM
IINET
IL
IM
IMMO
IMMOBILIEN
IN
INDUSTRIES
INFINITI
INFO
ING
INK
INSTITUTE
INSURE
INT
INTERNATIONAL
INVESTMENTS
IO
IPIRANGA
IQ
IR
IRISH
IS
IST
ISTANBUL
IT
ITAU
IWC
JAVA
JCB
JE
JETZT
JEWELRY
JLC
JLL
JM
JO
JOBS
JOBURG
JP
JPRS
JUEGOS
KAUFEN
KDDI
KE
KG
KH
KI
KIM
KITCHEN
KIWI
KM
KN
KOELN
KOMATSU
KP
KR
KRD
KRED
KW
KY
KYOTO
KZ
LA
LACAIXA
LANCASTER
LAND
LASALLE
LAT
LATROBE
LAW
LAWYER
LB
LC
LDS
LEASE
LECLERC
LEGAL
LEXUS
LGBT
LI
LIAISON
LIDL
LIFE
LIGHTING
LIMITED
LIMO
LINK
LIVE
LIXIL
LK
LOAN
LOANS
LOL
LONDON
LOTTE
LOTTO
LOVE
LR
LS
LT
LTDA
LU
LUPIN
LUXE
LUXURY
LV
LY
MA
MADRID
MAIF
MAISON
MAN
MANAGEMENT
MANGO
MARKET
MARKETING
MARKETS
MARRIOTT
MBA
MC
MD
ME
MEDIA
MEET
MELBOURNE
MEME
MEMORIAL
MEN
MENU
MG
MH
MIAMI
MICROSOFT
MIL
MINI
MK
ML
MM
MMA
MN
MO
MOBI
MODA
MOE
MOM
MONASH
MONEY
MONTBLANC
MORMON
MORTGAGE
MOSCOW
MOTORCYCLES
MOV
MOVIE
MOVISTAR
MP
MQ
MR
MS
MT
MTN
MTPC
MU
MUSEUM
MV
MW
MX
MY
MZ
NA
NADEX
NAGOYA
NAME
NAVY
NC
NE
NEC
NET
NETBANK
NETWORK
NEUSTAR
NEW
NEWS
NEXUS
NF
NG
NGO
NHK
NI
NICO
NINJA
NISSAN
NL
NO
NOKIA
NP
NR
NRA
NRW
NTT
NU
NYC
NZ
OFFICE
OKINAWA
OM
OMEGA
ONE
ONG
ONL
ONLINE
OOO
ORACLE
ORANGE
ORG
ORGANIC
OSAKA
OTSUKA
OVH
PA
PAGE
PANERAI
PARIS
PARTNERS
PARTS
PARTY
PE
PET
PF
PG
PH
PHARMACY
PHILIPS
PHOTO
PHOTOGRAPHY
PHOTOS
PHYSIO
PIAGET
PICS
PICTET
PICTURES
PINK
PIZZA
PK
PL
PLACE
PLAY
PLUMBING
PLUS
PM
PN
POHL
POKER
PORN
POST
PR
PRAXI
PRESS
PRO
PROD
PRODUCTIONS
PROF
PROPERTIES
PROPERTY
PS
PT
PUB
PW
PY
QA
QPON
QUEBEC
RACING
RE
REALTOR
REALTY
RECIPES
RED
REDSTONE
REHAB
REISE
REISEN
REIT
REN
RENT
RENTALS
REPAIR
REPORT
REPUBLICAN
REST
RESTAURANT
REVIEW
REVIEWS
RICH
RICOH
RIO
RIP
RO
ROCKS
RODEO
RS
RSVP
RU
RUHR
RUN
RW
RYUKYU
SA
SAARLAND
SAKURA
SALE
SAMSUNG
SANDVIK
SANDVIKCOROMANT
SANOFI
SAP
SARL
SAXO
SB
SC
SCA
SCB
SCHMIDT
SCHOLARSHIPS
SCHOOL
SCHULE
SCHWARZ
SCIENCE
SCOR
SCOT
SD
SE
SEAT
SEEK
SENER
SERVICES
SEW
SEX
SEXY
SG
SH
SHIKSHA
SHOES
SHOW
SHRIRAM
SI
SINGLES
SITE
SJ
SK
SKI
SKY
SKYPE
SL
SM
SN
SNCF
SO
SOCCER
SOCIAL
SOFTWARE
SOHU
SOLAR
SOLUTIONS
SONY
SOY
SPACE
SPIEGEL
SPREADBETTING
SR
SRL
ST
STARHUB
STATOIL
STC
STCGROUP
STUDIO
STUDY
STYLE
SU
SUCKS
SUPPLIES
SUPPLY
SUPPORT
SURF
SURGERY
SUZUKI
SV
SWATCH
SWISS
SX
SY
SYDNEY
SYSTEMS
SZ
TAIPEI
TATAMOTORS
TATAR
TATTOO
TAX
TAXI
TC
TD
TEAM
TECH
TECHNOLOGY
TEL
TELEFONICA
TEMASEK
TENNIS
TF
TG
TH
THD
THEATER
TICKETS
TIENDA
TIPS
TIRES
TIROL
TJ
TK
TL
TM
TN
TO
TODAY
TOOLS
TOP
TORAY
TOURS
TOWN
TOYOTA
TOYS
TR
TRADE
TRADING
TRAINING
TRAVEL
TRUST
TT
TUI
TV
TW
TZ
UA
UBS
UG
UK
UNO
UOL
US
UY
UZ
VA
VC
VE
VEGAS
VET
VG
VI
VIAJES
VIDEO
VILLAS
VIN
VISION
VISTA
VIVA
VLAANDEREN
VN
VOTE
VOTING
VOTO
VOYAGE
VU
WALES
WALTER
WANG
WATCH
WEBCAM
WEBSITE
WED
WEDDING
WEIR
WF
WHOSWHO
WIEN
WIKI
WIN
WINE
WME
WORK
WORKS
WORLD
WS
WTC
WTF
XIN
XN
XYZ
YACHTS
YE
YOGA
YT
ZA
ZIP
ZM
ZONE
ZW
"""

def whois_check(word, tld):
    try:
        domain = word[:len(word)-len(tld)] + '.' + tld
        if whois.whois(domain)["expiration_date"]:
            return True
    except (UnboundLocalError, KeyError):
        pass
    except whois.parser.PywhoisError:           # this isn't 100% accurate
            return True

open_domains = open_domains.split('\n')
open_domains = [i.lower().rstrip() for i in open_domains if i!='']

# f = open('/usr/share/dict/words')
f = open('words.txt')
results = open('results',"wb")

while True:
    try:
        word = f.readline().lower().rstrip()
        if word != '':
            matches = [(word, i) for i in open_domains if word.endswith(i) and word != i and whois_check(word,i)]
            if len(matches) > 0:
            pickle.dump(matches, results)
    except EOFError:
        exit()